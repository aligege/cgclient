//
// (c) 2021 Eduardo Doria.
//

#include "SpriteAnimation.h"

using namespace cg;

SpriteAnimation::SpriteAnimation(Scene* scene): Action(scene){
    addComponent<SpriteAnimationComponent>({});
}

void SpriteAnimation::setAnimation(std::vector<int> frames, std::vector<int> framesTime, bool loop){
    if (frames.size() <= 0 || framesTime.size() <= 0) {
        Log::error("Cannot set animation without frames or intervals");
        return;
    }

    SpriteAnimationComponent& spriteanim = getComponent<SpriteAnimationComponent>();

    spriteanim.framesTimeSize = framesTime.size();
    for (int i = 0; i < framesTime.size(); i++){
        spriteanim.framesTime[i] = framesTime[i];
    }

    spriteanim.framesSize = frames.size();
    for (int i = 0; i < frames.size(); i++){
        spriteanim.frames[i] = frames[i];
    }

    spriteanim.loop = loop;
}

void SpriteAnimation::setAnimation(int startFrame, int endFrame, int interval, bool loop){
    std::vector<int> frames;
    std::vector<int> framesTime;

    if (startFrame > 0 || endFrame > 0) {
        for (int i=startFrame; i<=endFrame; i++){
            frames.push_back(i);
            framesTime.push_back(interval);
        }
    }

    setAnimation(frames, framesTime, loop);
}